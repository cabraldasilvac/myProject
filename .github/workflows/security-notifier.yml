name: Notificador de Alertas de Seguran√ßa

on:
  dependabot_alert:
    types: [created, reopened]
  code_scanning_alert:
    types: [created, reopened]
  security_advisory:
    types: [published]
  workflow_dispatch:

jobs:
  enviar-notificacao-slack:
    runs-on: ubuntu-latest
    steps:
      - name: Enviar Notifica√ß√£o sobre Alerta do Dependabot
        if: github.event_name == 'dependabot_alert'
        uses: cabraldasilvac/security-alert-notifier-action@main
        with:
          slack-channel-id: "C099V8S4GDD"
          slack-message: |
            üö® *Novo Alerta de Seguran√ßa (Dependabot)*
            *Reposit√≥rio:* ${{ github.repository }}
            *Depend√™ncia:* `${{ github.event.alert.dependency.package.name }}`
            *Severidade:* `${{ github.event.alert.severity }}`
            *Link:* ${{ github.event.alert.html_url }}
        env:
          SLACK_BOT_TOKEN: ${{ secrets.SLACK_BOT_TOKEN }}

      - name: Enviar Notifica√ß√£o sobre Alerta de Varredura de C√≥digo (CodeQL)
        if: github.event_name == 'code_scanning_alert'
        uses: cabraldasilvac/security-alert-notifier-action@main
        with:
          slack-channel-id: "C099V8S4GDD"
          slack-message: |
            üî¨ *Novo Alerta de Seguran√ßa (Code Scanning)*
            *Reposit√≥rio:* ${{ github.repository }}
            *Ferramenta:* `${{ github.event.alert.tool.name }}`
            *Regra:* `${{ github.event.alert.rule.id }}`
            *Severidade:* `${{ github.event.alert.rule.severity }}`
            *Link:* ${{ github.event.alert.html_url }}
        env:
          SLACK_BOT_TOKEN: ${{ secrets.SLACK_BOT_TOKEN }}

      - name: Enviar Notifica√ß√£o sobre Aviso de Seguran√ßa (Security Advisory)
        if: github.event_name == 'security_advisory'
        uses: cabraldasilvac/security-alert-notifier-action@main
        with:
          slack-channel-id: "C099V8S4GDD"
          slack-message: |
            üì¢ *Novo Aviso de Seguran√ßa Global (Security Advisory)*
            *Reposit√≥rio:* ${{ github.repository }}
            *Sum√°rio:* `${{ github.event.security_advisory.summary }}`
            *Severidade:* `${{ github.event.security_advisory.severity }}`
            *Link:* ${{ github.event.security_advisory.html_url }}
        env:
          SLACK_BOT_TOKEN: ${{ secrets.SLACK_BOT_TOKEN }}

      - name: Enviar Notifica√ß√£o sobre Teste Manual
        if: github.event_name == 'workflow_dispatch'
        uses: cabraldasilvac/security-alert-notifier-action@main
        with:
          slack-channel-id: "C099V8S4GDD"
          slack-message: "‚úÖ Teste manual do notificador de seguran√ßa para o reposit√≥rio ${{ github.repository }}."
        env:
          SLACK_BOT_TOKEN: ${{ secrets.SLACK_BOT_TOKEN }}
